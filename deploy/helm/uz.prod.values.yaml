server:
  replicas: 2

  resources:
    requests:
      cpu: 400m
      memory: 512Mi
    limits:
      cpu: 700m
      memory: 1Gi

  postgres:
    host: wms-db.master.prod.um.internal

  config:
    # xmx must be lower than memory limit by 10-20%
    javaOpts: -Xmx866m
    spring:
      kafka:
        producerClientId: prod-${HOSTNAME}
        consumerClientId: prod-${HOSTNAME}
        bootstrapServers: rc1b-96p5j4p85cafv987.mdb.yandexcloud.net:9092
      sleuth:
        samplerProbability: '0.1'
      feign:
        readTimeout: '60000'
    wms:
      oauth2:
        enableAuthentication: false
        tokenServiceAddress: http://wms-account
        authorization:
          accessTokenValidity: '86400'
          refreshTokenValidity: '259200'

  monitoring:
    additionalLabels:
      prometheus: default

  ingress:
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      kubernetes.io/ingress.allow-http: "false"
      kubernetes.io/tls-acme: "true"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/affinity: "cookie"
      nginx.ingress.kubernetes.io/session-cookie-name: "route"
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/rewrite-target: /$1
    className: nginx-api
    tls:
      - hosts:
          - api.wms.umarket.uz
          - api-wms.uzum.uz
        secretName: wms-api-metaship-ssl
    rules:
      - host: api.wms.umarket.uz
        paths:
          - path: /metaship/(.*)
            pathType: ImplementationSpecific
            port: 80
      - host: api-wms.uzum.uz
        paths:
          - path: /metaship/(.*)
            pathType: ImplementationSpecific
            port: 80

  nodeSelector:
    app_type: apps

  tolerations:
    - key: app_type
      effect: NoSchedule
      operator: Equal
      value: apps
